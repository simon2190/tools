<mxfile host="65bd71144e">
    <diagram id="X6Rw26c9M3TBG2hz4Sk1" name="授权码模式">
        <mxGraphModel dx="664" dy="468" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="3300" pageHeight="4681" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" value="用户" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="90" y="130" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="浏览器" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
                    <mxGeometry x="250" y="130" width="70" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="51" value="" style="edgeStyle=none;html=1;dashed=1;endArrow=none;endFill=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4" target="79">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="网关&amp;nbsp; [ 服务A/B/C ]" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="455" y="130" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="SSO认证服务" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#EAFFE9;strokeColor=#82b366;" vertex="1" parent="1">
                    <mxGeometry x="715" y="130" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="107.5" y="414" width="25" height="86" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="" style="endArrow=none;dashed=1;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="13" target="2">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="60" y="240" as="sourcePoint"/>
                        <mxPoint x="110" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="23" style="edgeStyle=none;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;dashed=1;endArrow=none;endFill=0;" edge="1" parent="1" source="92" target="3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="21" value="A&lt;br&gt;页面" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="272.5" y="210" width="25" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="123" y="194" as="sourcePoint"/>
                        <mxPoint x="283" y="194" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="28" value="访问应用A" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="172" y="163" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="502.5" y="210" width="25" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="305" y="235" as="sourcePoint"/>
                        <mxPoint x="497.5" y="235" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="32" value="请求A服务接口" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="349" y="213" width="100" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="33" value="" style="endArrow=classic;html=1;dashed=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500" y="280.9999999999999" as="sourcePoint"/>
                        <mxPoint x="297.5" y="280.9999999999999" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="48" value="未登录&lt;br&gt;(token失效)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="530" y="240" width="70" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="返回301 认证服务地址" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="339.75" y="259" width="140" height="21" as="geometry"/>
                </mxCell>
                <mxCell id="52" value="登&lt;br&gt;录&lt;br&gt;页" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="272.5" y="400" width="27.5" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="55" value="" style="endArrow=classic;html=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="298.75" y="352.58" as="sourcePoint"/>
                        <mxPoint x="756.25" y="352.58" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="56" value="捕获301, 跳转到认证服务地址(同上地址)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#FFFFFF;shadow=0;sketch=0;gradientColor=none;" vertex="1" parent="1">
                    <mxGeometry x="377.75" y="330" width="277" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="57" value="未登录&lt;br&gt;(token失效)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="795" y="360" width="70" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="58" value="" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="750" y="420" as="sourcePoint"/>
                        <mxPoint x="310" y="420" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="59" value="重定向到单点登录页面地址&amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="340" y="400" width="190" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="60" value="" style="endArrow=classic;html=1;dashed=1;entryX=1;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="270.75" y="452.17" as="sourcePoint"/>
                        <mxPoint x="133.25" y="451.67" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="61" value="展示登录表单" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="157.75" y="434.17" width="90" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="63" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="133.25" y="479.17" as="sourcePoint"/>
                        <mxPoint x="270.75" y="479.17" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="64" value="填写账号密码" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="160.75" y="462.17" width="80" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="66" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="762.5" y="467.17" width="25" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="67" value="" style="endArrow=classic;html=1;entryX=-0.013;entryY=0.304;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="303.19" y="502.17" as="sourcePoint"/>
                        <mxPoint x="760.4999999999999" y="502.5700000000001" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="68" value="&amp;nbsp;提交登录请求ajax" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="464.41" y="480" width="115.59" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="70" value="校验通过" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="794" y="522.17" width="32.5" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="72" value="" style="endArrow=classic;html=1;dashed=1;entryX=1.084;entryY=0.275;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="755" y="544.2500000000001" as="sourcePoint"/>
                        <mxPoint x="302" y="544" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="76" value="" style="edgeStyle=none;html=1;dashed=1;endArrow=none;endFill=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;startArrow=none;" edge="1" parent="1" source="54" target="66">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="525" y="170" as="sourcePoint"/>
                        <mxPoint x="525" y="220" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="54" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="762.5" y="310" width="25" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="78" value="" style="edgeStyle=none;html=1;dashed=1;endArrow=none;endFill=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="8" target="54">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="780" y="160" as="sourcePoint"/>
                        <mxPoint x="777.5" y="480" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="79" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="502.5" y="630" width="27.5" height="190" as="geometry"/>
                </mxCell>
                <mxCell id="80" value="" style="endArrow=classic;html=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="300" y="660" as="sourcePoint"/>
                        <mxPoint x="500" y="660" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="81" value="请求A服务获取token接口" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="310" y="639" width="190" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="84" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="762.5" y="650" width="25" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="87" value="" style="endArrow=classic;html=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="530" y="680" as="sourcePoint"/>
                        <mxPoint x="758" y="680" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="88" value="使用code和client参数获取token" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="549" y="655" width="190" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="89" value="校验code和client" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="800" y="690" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="90" value="" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="762.5" y="739.77" as="sourcePoint"/>
                        <mxPoint x="533" y="740" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="91" value="返回token" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="592.5" y="715" width="103" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="92" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="271.25" y="735" width="27.5" height="220" as="geometry"/>
                </mxCell>
                <mxCell id="93" value="" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="497" y="775" as="sourcePoint"/>
                        <mxPoint x="307" y="775" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="94" value="返回token,设置cookie" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="339.75" y="750" width="130.5" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="96" value="基于前后端分离 并且满足跨域模式下的&lt;br&gt;oauth2.0 单点登录流程" style="text;html=1;strokeColor=#36393d;fillColor=#D6FFEF;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="87.25" y="40" width="282.75" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="105" value="返回登录成功后 登录页需重定向的url" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="372" y="522.17" width="312" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="106" value="s1" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="442.07" y="480" width="28.18" height="17.83" as="geometry"/>
                </mxCell>
                <mxCell id="108" value="s2" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="795" y="510" width="25" height="17.83" as="geometry"/>
                </mxCell>
                <mxCell id="109" value="s3" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="400" y="522.17" width="25.59" height="17.83" as="geometry"/>
                </mxCell>
                <mxCell id="110" value="应用A前端&amp;nbsp; xian-yuan.net/server-a&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;简称&amp;nbsp; app-a&lt;br&gt;SSO后端&amp;nbsp; &amp;nbsp; xian-yuan.net/system-sso&amp;nbsp; &amp;nbsp; 简称&amp;nbsp; system-sso&lt;br&gt;SSO前端&amp;nbsp; &amp;nbsp; xian-yuan.net/platform-sso&amp;nbsp; &amp;nbsp;简称 platform-sso&lt;br&gt;&lt;font style=&quot;background-color: rgb(255 , 255 , 0)&quot;&gt;标黄的内容&lt;/font&gt;&lt;font&gt;&amp;nbsp; &amp;nbsp;&lt;/font&gt;会在文档中有详细解读" style="text;html=1;strokeColor=#36393d;fillColor=#D6FFEF;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="449" y="40" width="311.37" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="111" value="(http://sso/oauth/authorize?response_type&lt;br&gt;=code&amp;amp;client_id=**&amp;amp;redirect_uri=appa/**)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="302" y="282" width="200" height="31" as="geometry"/>
                </mxCell>
                <mxCell id="115" value="&lt;font style=&quot;font-size: 10px&quot;&gt;(http://platform-sso/login?resp**client**redirect**)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
                    <mxGeometry x="510" y="400" width="221" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="117" value="A2" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="377.75" y="332.09000000000003" width="28.18" height="17.83" as="geometry"/>
                </mxCell>
                <mxCell id="118" value="A3" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=10;" vertex="1" parent="1">
                    <mxGeometry x="329" y="399.17" width="28.18" height="17.83" as="geometry"/>
                </mxCell>
                <mxCell id="119" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 16px;&quot;&gt;注：&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;fontSize=16;fontColor=#CCFFE6;" vertex="1" parent="1">
                    <mxGeometry x="407.07" y="50" width="35" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="120" value="&lt;font style=&quot;font-size: 10px&quot;&gt;A1&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#FFFFCC;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;sketch=0;" vertex="1" parent="1">
                    <mxGeometry x="321" y="259" width="28.18" height="17.83" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>